name: Auto Deploy

on:
  push:
    branches: [ "main" ]
jobs:
  deploy:
    runs-on: self-hosted
    steps:
      - name: Deploy on Local Machine
        run: |
          cd /home/hong/accounting-project-new
          git pull origin main

          # Build and restart Docker services (frontend built inside Docker)
          docker compose -f docker-compose.prod.yml build --pull
          docker compose -f docker-compose.prod.yml up -d --remove-orphans

          # Cleanup
          docker image prune -f

# Production Dockerfile - Builds static files and outputs to volume
FROM node:20-alpine

WORKDIR /app

# Copy package files
COPY package*.json ./

# Install dependencies
RUN npm install

# Copy source code
COPY . .

# Build for production (skip TypeScript checking for faster builds)
RUN npm run build:prod

# Copy built files to volume mount point
# The volume will be mounted at /dist and shared with nginx
CMD cp -r /app/dist/* /dist/ && echo "Frontend built successfully!" && tail -f /dev/null
